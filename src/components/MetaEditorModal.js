import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from 'react';
const MetaEditorModal = ({ kind, initial, onClose, onSaved }) => {
    const [title, setTitle] = useState(initial.title || '');
    const [status, setStatus] = useState(initial.status || '');
    const [route, setRoute] = useState(initial.route || '');
    const [notes, setNotes] = useState(initial.notes || '');
    const [domain, setDomain] = useState(initial.domain || '');
    const [area, setArea] = useState(initial.area || '');
    const [component, setComponent] = useState(initial.component || '');
    const [action, setAction] = useState(initial.action || '');
    const [klass, setKlass] = useState(initial.class || '');
    const [links, setLinks] = useState(initial.links || []);
    const [saving, setSaving] = useState(false);
    const addLink = () => setLinks((prev) => [...prev, { to: '', label: '' }]);
    const setLink = (i, k, v) => setLinks(prev => prev.map((it, idx) => idx === i ? { ...it, [k]: v } : it));
    const removeLink = (i) => setLinks(prev => prev.filter((_, idx) => idx !== i));
    const routeValid = route === '' || route.startsWith('/');
    const save = async () => {
        setSaving(true);
        try {
            const meta = { title, status, route, notes, domain, area, component, action, class: klass, links };
            onSaved(meta);
        }
        finally {
            setSaving(false);
        }
    };
    return (_jsxs("div", { className: "fixed inset-0 z-50 flex items-center justify-center", children: [_jsx("div", { className: "absolute inset-0 bg-black/40", onClick: () => !saving && onClose() }), _jsxs("div", { className: "relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-3xl p-6", children: [_jsxs("div", { className: "flex items-center justify-between mb-4", children: [_jsxs("h3", { className: "text-lg font-semibold text-gray-900 dark:text-white", children: ["\u7DE8\u8F2F Meta\uFF08", kind === 'page' ? '頁面' : '子頁', "\uFF09"] }), _jsx("button", { className: "btn-secondary", onClick: onClose, disabled: saving, children: "\u95DC\u9589" })] }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4", children: [_jsxs("div", { children: [_jsx("label", { className: "block text-sm mb-1", children: "\u6A19\u984C" }), _jsx("input", { value: title, onChange: (e) => setTitle(e.target.value), className: "w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm mb-1", children: "\u72C0\u614B\uFF08draft/ready/...\uFF09" }), _jsx("input", { value: status, onChange: (e) => setStatus(e.target.value), className: "w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm mb-1", children: "\u8DEF\u7531\uFF08\u4EE5 / \u958B\u982D\uFF09" }), _jsx("input", { value: route, onChange: (e) => setRoute(e.target.value), className: 'w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white' + (routeValid ? '' : ' border-red-500') })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm mb-1", children: "\u985E\u5225\uFF08pageLevel/componentLevel/decision/toolbar/form/table\uFF09" }), _jsx("input", { value: klass, onChange: (e) => setKlass(e.target.value), className: "w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm mb-1", children: "Domain" }), _jsx("input", { value: domain, onChange: (e) => setDomain(e.target.value), className: "w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm mb-1", children: "Area" }), _jsx("input", { value: area, onChange: (e) => setArea(e.target.value), className: "w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm mb-1", children: "Component" }), _jsx("input", { value: component, onChange: (e) => setComponent(e.target.value), className: "w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm mb-1", children: "Action" }), _jsx("input", { value: action, onChange: (e) => setAction(e.target.value), className: "w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" })] }), _jsxs("div", { className: "md:col-span-2", children: [_jsx("label", { className: "block text-sm mb-1", children: "\u5099\u8A3B" }), _jsx("textarea", { value: notes, onChange: (e) => setNotes(e.target.value), rows: 3, className: "w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" })] }), _jsxs("div", { className: "md:col-span-2", children: [_jsxs("div", { className: "flex items-center justify-between mb-1", children: [_jsx("label", { className: "block text-sm", children: "\u9023\u7D50\uFF08links\uFF09" }), _jsx("button", { className: "btn-secondary text-sm", onClick: addLink, type: "button", children: "\u65B0\u589E\u9023\u7D50" })] }), _jsxs("div", { className: "space-y-2", children: [links.map((l, i) => (_jsxs("div", { className: "grid grid-cols-1 md:grid-cols-12 gap-2 items-center", children: [_jsx("input", { value: l.to, onChange: (e) => setLink(i, 'to', e.target.value), placeholder: "/orders/list \u6216 module_id/page_id", className: "md:col-span-6 px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" }), _jsx("input", { value: l.label || '', onChange: (e) => setLink(i, 'label', e.target.value), placeholder: "\u6A19\u7C64\uFF08\u53EF\u7A7A\uFF09", className: "md:col-span-5 px-3 py-2 border rounded dark:bg-gray-700 dark:text-white" }), _jsx("button", { className: "btn-secondary", onClick: () => removeLink(i), type: "button", children: "\u522A\u9664" })] }, i))), links.length === 0 && _jsx("div", { className: "text-xs text-gray-500", children: "\u5C1A\u7121\u9023\u7D50" })] })] })] }), _jsxs("div", { className: "mt-4 flex items-center justify-end gap-2", children: [_jsx("button", { className: "btn-secondary", onClick: onClose, disabled: saving, children: "\u53D6\u6D88" }), _jsx("button", { className: "btn-primary", onClick: save, disabled: saving || !routeValid, children: saving ? '儲存中…' : '儲存' })] })] })] }));
};
export default MetaEditorModal;
